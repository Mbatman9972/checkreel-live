<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CheckReel Admin Control Room</title>
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#667eea" />
    <style>
/*  —————  ORIGINAL STYLES (unchanged)  —————  */
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;color:#333;line-height:1.6;transition:.3s}
        [dir=rtl]{direction:rtl;text-align:right}
        [dir=rtl] .header-controls{flex-direction:row-reverse}
        [dir=rtl] .main-container{grid-template-columns:320px 1fr}
        [dir=rtl] .logo-section{flex-direction:row-reverse}
        .header{background:rgba(255,255,255,.1);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.2);padding:1rem 2rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem}
        .logo-section{display:flex;align-items:center;gap:1rem}
        .logo{font-size:2rem;font-weight:bold;color:#fff}
        .header-controls{display:flex;align-items:center;gap:1rem;flex-wrap:wrap}
        .language-selector,.pwa-install,.control-toggle{background:rgba(255,255,255,.2);border:1px solid rgba(255,255,255,.3);color:#fff;padding:.5rem 1rem;border-radius:8px;cursor:pointer;transition:.3s}
        .language-selector:hover,.pwa-install:hover,.control-toggle:hover{background:rgba(255,255,255,.3);transform:translateY(-2px)}
        .control-toggle.active{background:rgba(76,175,80,.3)}
        .main-container{display:grid;grid-template-columns:1fr 320px;gap:2rem;padding:2rem;max-width:1600px;margin:0 auto}
        .dashboard-content{display:flex;flex-direction:column;gap:2rem}
        .status-bar{background:rgba(255,255,255,.1);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);border-radius:16px;padding:1rem 2rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem}
        .status-item{display:flex;align-items:center;gap:.5rem;color:#fff}
        .status-indicator{width:12px;height:12px;border-radius:50%;animation:pulse 2s infinite}
        .status-indicator.online{background:#4CAF50}.status-indicator.warning{background:#FF9800}.status-indicator.error{background:#F44336}
        @keyframes pulse{0%{opacity:1}50%{opacity:.5}100%{opacity:1}}
        .kpi-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}
        .kpi-card{background:rgba(255,255,255,.1);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);border-radius:16px;padding:1.5rem;transition:.3s;cursor:pointer;position:relative;overflow:hidden}
        .kpi-card::before{content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#4CAF50,#2196F3,#FF9800,#F44336)}
        .kpi-card:hover{transform:translateY(-5px);background:rgba(255,255,255,.15)}
        .kpi-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}
        .kpi-title{color:rgba(255,255,255,.8);font-size:.9rem;font-weight:500}
        .kpi-icon{font-size:1.5rem}
        .kpi-value{font-size:2rem;font-weight:bold;color:#fff;margin-bottom:.5rem}
        .kpi-change{font-size:.85rem;font-weight:500;display:flex;align-items:center;gap:.25rem}
        .kpi-change.positive{color:#4ade80}.kpi-change.negative{color:#f87171}.kpi-change.neutral{color:#94a3b8}
        .user-tier-management{background:rgba(255,255,255,.1);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);border-radius:16px;padding:2rem;margin-bottom:2rem}
        .section-title{font-size:1.3rem;font-weight:600;color:#fff;margin-bottom:1.5rem;display:flex;align-items:center;gap:.5rem}
        .tier-upgrade-form{display:grid;grid-template-columns:2fr 1fr auto;gap:1rem;align-items:end}
        .form-group{display:flex;flex-direction:column;gap:.5rem}
        .form-label{color:rgba(255,255,255,.9);font-size:.9rem;font-weight:500}
        .form-input,.form-select{padding:.75rem;border-radius:8px;border:1px solid rgba(255,255,255,.3);background:rgba(255,255,255,.1);color:#fff;font-size:1rem;transition:.3s}
        .form-input::placeholder{color:rgba(255,255,255,.5)}
        .form-input:focus,.form-select:focus{outline:none;border-color:rgba(255,255,255,.5);background:rgba(255,255,255,.15)}
        .form-select option{background:#667eea;color:#fff}
        .btn-upgrade{background:rgba(76,175,80,.3);border:1px solid rgba(76,175,80,.5);color:#fff;padding:.75rem 1.5rem;border-radius:8px;cursor:pointer;font-size:1rem;font-weight:500;transition:.3s;display:flex;align-items:center;gap:.5rem}
        .btn-upgrade:hover{background:rgba(76,175,80,.4);transform:translateY(-2px)}
        .btn-upgrade:disabled{opacity:.6;cursor:not-allowed}
        .charts-grid{display:grid;grid-template-columns:2fr 1fr;gap:2rem}
        .chart-container{background:rgba(255,255,255,.1);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);border-radius:16px;padding:2rem}
        .chart-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}
        .chart-title{font-size:1.2rem;font-weight:600;color:#fff;display:flex;align-items:center;gap:.5rem}
        .chart-controls{display:flex;gap:.5rem}
        .chart-btn{background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.2);color:rgba(255,255,255,.8);padding:.25rem .75rem;border-radius:6px;cursor:pointer;transition:.3s;font-size:.8rem}
        .chart-btn.active,.chart-btn:hover{background:rgba(255,255,255,.2);color:#fff}
        .analytics-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:2rem;margin-top:2rem}
        .analytics-card{background:rgba(255,255,255,.1);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);border-radius:16px;padding:1.5rem}
        .analytics-title{font-size:1.1rem;font-weight:600;color:#fff;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}
        .metric-item{display:flex;justify-content:space-between;align-items:center;padding:.75rem 0;border-bottom:1px solid rgba(255,255,255,.1)}
        .metric-item:last-child{border-bottom:none}
        .metric-label{color:rgba(255,255,255,.8);font-size:.9rem}
        .metric-value{color:#fff;font-weight:600}
        .sidebar{display:flex;flex-direction:column;gap:2rem}
        .sidebar-section{background:rgba(255,255,255,.1);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);border-radius:16px;padding:1.5rem}
        .sidebar-title{font-size:1.1rem;font-weight:600;color:#fff;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}
        .quick-action,.activity-item,.alert-item{display:flex;align-items:center;gap:1rem;padding:.75rem;background:rgba(255,255,255,.05);border-radius:8px;margin-bottom:.5rem;cursor:pointer;transition:.3s}
        .quick-action:hover,.activity-item:hover{background:rgba(255,255,255,.1);transform:translateX(5px)}
        .alert-item.critical{border-left:4px solid #F44336}.alert-item.warning{border-left:4px solid #FF9800}.alert-item.info{border-left:4px solid #2196F3}
        .action-icon,.activity-icon,.alert-icon{font-size:1.2rem}
        .action-text,.activity-text,.alert-text{color:#fff;font-weight:500;flex:1}
        .activity-details,.alert-details{display:flex;flex-direction:column;flex:1}
        .activity-time,.alert-time{color:rgba(255,255,255,.6);font-size:.8rem}
        .toast{position:fixed;bottom:2rem;right:2rem;background:rgba(255,255,255,.95);backdrop-filter:blur(10px);border-radius:8px;padding:1rem 1.5rem;box-shadow:0 4px 12px rgba(0,0,0,.2);display:flex;align-items:center;gap:.75rem;transform:translateY(100px);opacity:0;transition:.3s;z-index:1000}
        .toast.show{transform:translateY(0);opacity:1}
        .toast.success{border-left:4px solid #4CAF50}.toast.error{border-left:4px solid #F44336}
        .toast-icon{font-size:1.5rem}.toast-message{color:#333;font-weight:500}
        .spinner{border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;width:16px;height:16px;animation:spin .8s linear infinite;display:inline-block}
        @keyframes spin{to{transform:rotate(360deg)}}
        @media(max-width:1200px){.charts-grid{grid-template-columns:1fr}.tier-upgrade-form{grid-template-columns:1fr}}
        @media(max-width:1024px){.main-container{grid-template-columns:1fr}.sidebar{order:-1}.analytics-grid{grid-template-columns:1fr}}
        @media(max-width:768px){.header{padding:1rem}.main-container{padding:1rem;gap:1rem}.kpi-grid{grid-template-columns:1fr}}
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo-section">
            <div class="logo" data-i18n="controlRoomTitle">CheckReel Control Room</div>
            <div id="pwaStatus" style="color:rgba(255,255,255,.7);font-size:.9rem"></div>
        </div>
        <div class="header-controls">
            <select id="languageSelector" class="language-selector">
                <option value="en">🇺🇸 English</option>
                <option value="ar">🇸🇦 العربية</option>
            </select>
            <button id="controlToggle" class="control-toggle">🔴 Live Mode</button>
            <button id="installPWA" class="pwa-install" style="display:none">📱 Install App</button>
        </div>
    </header>

    <!-- Status Bar -->
    <div class="status-bar">
        <div class="status-item"><div class="status-indicator online"></div><span data-i18n="systemStatus">System Status: Online</span></div>
        <div class="status-item"><div class="status-indicator online"></div><span data-i18n="apiStatus">API: Healthy</span></div>
        <div class="status-item"><div class="status-indicator warning"></div><span data-i18n="queueStatus">Queue: 847 pending</span></div>
        <div class="status-item"><div class="status-indicator online"></div><span data-i18n="dbStatus">Database: Connected</span></div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Dashboard Content -->
        <div class="dashboard-content">
            <!-- KPI Grid -->
            <div class="kpi-grid">
                <!-- 6 KPI cards (unchanged markup) -->
                <div class="kpi-card" onclick="openModal('revenueModal')">
                    <div class="kpi-header"><h4 class="kpi-title" data-i18n="todayRevenue">Today's Revenue</h4><div class="kpi-icon">💰</div></div>
                    <div class="kpi-value">$1,247</div><div class="kpi-change positive">↗ +18.4% <span style="font-size:.7rem">vs yesterday</span></div>
                </div>
                <div class="kpi-card" onclick="openModal('scansModal')">
                    <div class="kpi-header"><h4 class="kpi-title" data-i18n="activeScans">Active Scans</h4><div class="kpi-icon">🔍</div></div>
                    <div class="kpi-value">2,845</div><div class="kpi-change positive">↗ +12.3% <span style="font-size:.7rem">this hour</span></div>
                </div>
                <div class="kpi-card" onclick="openModal('violationsModal')">
                    <div class="kpi-header"><h4 class="kpi-title" data-i18n="violationsDetected">Violations Detected</h4><div class="kpi-icon">⚠️</div></div>
                    <div class="kpi-value">89</div><div class="kpi-change negative">↘ -5.2% <span style="font-size:.7rem">vs last hour</span></div>
                </div>
                <div class="kpi-card" onclick="openModal('usersModal')">
                    <div class="kpi-header"><h4 class="kpi-title" data-i18n="activeUsers">Active Users</h4><div class="kpi-icon">👥</div></div>
                    <div class="kpi-value">18,926</div><div class="kpi-change positive">↗ +7.8% <span style="font-size:.7rem">online now</span></div>
                </div>
                <div class="kpi-card" onclick="openModal('performanceModal')">
                    <div class="kpi-header"><h4 class="kpi-title" data-i18n="responseTime">Avg Response Time</h4><div class="kpi-icon">⚡</div></div>
                    <div class="kpi-value">143ms</div><div class="kpi-change positive">↗ -12ms <span style="font-size:.7rem">improved</span></div>
                </div>
                <div class="kpi-card" onclick="openModal('accuracyModal')">
                    <div class="kpi-header"><h4 class="kpi-title" data-i18n="accuracy">AI Accuracy</h4><div class="kpi-icon">🎯</div></div>
                    <div class="kpi-value">97.2%</div><div class="kpi-change positive">↗ +0.3% <span style="font-size:.7rem">this week</span></div>
                </div>
            </div>

            <!-- User Tier Management (unchanged markup) -->
            <!--  …  -->

            <!-- Charts Grid -->
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-header"><h3 class="chart-title">📈 <span data-i18n="revenueChart">Revenue Analytics</span></h3>
                        <div class="chart-controls">
                            <button class="chart-btn active" onclick="updateChart('24h')">24H</button>
                            <button class="chart-btn" onclick="updateChart('7d')">7D</button>
                            <button class="chart-btn" onclick="updateChart('30d')">30D</button>
                            <button class="chart-btn" onclick="updateChart('1y')">1Y</button>
                        </div>
                    </div>
                    <canvas id="revenueChart" height="300"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-header"><h3 class="chart-title">🎭 <span data-i18n="platformChart">Platform Distribution</span></h3></div>
                    <canvas id="platformChart" height="300"></canvas>
                </div>
            </div>

            <!-- Violations Chart + analytics grid -->
            <!--  …  (unchanged) -->
        </div>

        <!-- Sidebar -->
        <!--  …  (unchanged) -->
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"><span class="toast-icon" id="toastIcon"></span><span class="toast-message" id="toastMessage"></span></div>

    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="tier.js"></script>

    <script>
/* ——————————————————————  TRANSLATIONS  —————————————————————— */
const languages = {
  en:{ /* original keys … */ controlRoomTitle:"CheckReel Control Room"},
  ar:{ /* original keys … */ controlRoomTitle:"غرفة تحكم تشكريل"}
};

/* —————————————————  GLOBALS  ————————————————— */
let currentLanguage='en',charts={},liveMode=false,updateInterval;

/* —————————————————  INIT  ————————————————— */
document.addEventListener('DOMContentLoaded',()=>{
  updateLanguage(localStorage.getItem('checkReelLanguage')||'en');
  initializeCharts(); initializePWA(); setupEventListeners(); startLiveUpdates();
});

/* —————————————————  EVENT SETUP  ————————————————— */
function setupEventListeners(){
  const languageSelector=document.getElementById('languageSelector');
  if(languageSelector){
      languageSelector.addEventListener('change',e=>updateLanguage(e.target.value));
  }
  const controlToggle=document.getElementById('controlToggle');
  if(controlToggle){ controlToggle.addEventListener('click',toggleLiveMode); }
  const tierUpgradeForm=document.getElementById('tierUpgradeForm');
  if(tierUpgradeForm){ tierUpgradeForm.addEventListener('submit',handleTierUpgrade); }
}

/* —————————————————  LANGUAGE  ————————————————— */
function updateLanguage(lang){
  currentLanguage=lang;
  document.documentElement.setAttribute('lang',lang);
  document.documentElement.setAttribute('dir',lang==='ar'?'rtl':'ltr');
  const font=lang==='ar'?'Tahoma,Arial,sans-serif':'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif';
  document.body.style.fontFamily=font;
  document.querySelectorAll('[data-i18n]').forEach(el=>{
      const key=el.getAttribute('data-i18n');
      if(languages[lang] && languages[lang][key]) el.textContent=languages[lang][key];
  });
  updateChartsLanguage();
  localStorage.setItem('checkReelLanguage',lang);
}

/* —————————————————  CHARTS  ————————————————— */
function initializeCharts(){
  if(typeof Chart==='undefined'){setTimeout(initializeCharts,100);return;}
  try{
    const revenueCtx=document.getElementById('revenueChart');
    if(revenueCtx){
      charts.revenue=new Chart(revenueCtx,{
       type:'line',
       data:{labels:['00:00','04:00','08:00','12:00','16:00','20:00','24:00'],
             datasets:[{label:'Revenue ($)',data:[850,920,1100,1247,1180,1320,1400],
             borderColor:'#4CAF50',backgroundColor:'rgba(76,175,80,.1)',borderWidth:3,fill:true,tension:.4,
             pointBackgroundColor:'#4CAF50',pointBorderColor:'#fff',pointBorderWidth:2,pointRadius:6}]},
       options:{responsive:true,maintainAspectRatio:false,
         plugins:{legend:{display:false}},
         scales:{
           x:{ticks:{color:'rgba(255,255,255,.8)'},grid:{color:'rgba(255,255,255,.1)'}},
           y:{ticks:{
                 color:'rgba(255,255,255,.8)',
                 callback:v=>'$'+v     /* ← MONEY FORMAT FIX */
              },
              grid:{color:'rgba(255,255,255,.1)'}}
         }}
      });
    }
    const platformCtx=document.getElementById('platformChart');
    if(platformCtx){
      charts.platform=new Chart(platformCtx,{type:'doughnut',
        data:{labels:['TikTok','Instagram','YouTube','Facebook','Twitter'],
              datasets:[{data:[35,25,20,15,5],backgroundColor:['#FF6B6B','#4ECDC4','#45B7D1','#96CEB4','#FFEAA7'],borderWidth:0}]},
        options:{responsive:true,maintainAspectRatio:false,
                 plugins:{legend:{position:'bottom',labels:{color:'rgba(255,255,255,.8)'}}}}
      });
    }
    const violationsCtx=document.getElementById('violationsChart');
    if(violationsCtx){
      charts.violations=new Chart(violationsCtx,{type:'bar',
        data:{labels:['Language','Violence','Spam','Copyright','Adult','Hate'],
              datasets:[{label:'Violations',data:[89,45,67,23,12,8],
                       backgroundColor:['#FF6B6B','#FF8E53','#FF6B9D','#C44569','#F8B500','#FF3838'],
                       borderRadius:8,borderSkipped:false}]},
        options:{responsive:true,maintainAspectRatio:false,
                 plugins:{legend:{display:false}},
                 scales:{x:{ticks:{color:'rgba(255,255,255,.8)'},grid:{display:false}},
                         y:{ticks:{color:'rgba(255,255,255,.8)'},grid:{color:'rgba(255,255,255,.1)'}}}}
      });
    }
  }catch(err){console.error('Error initializing charts:',err);}
}
function updateChartsLanguage(){ if(charts.platform)charts.platform.update(); if(charts.violations)charts.violations.update(); }

/* —————————————————  KPI LIVE UPDATE  ————————————————— */
function updateLiveData(){
  document.querySelectorAll('.kpi-value').forEach(card=>{
    const curr=parseInt(card.textContent.replace(/[^0-9]/g,''))||0;
    const diff=Math.floor(Math.random()*20)-10;
    const val=Math.max(0,curr+diff);
    if(card.textContent.includes('$'))       {card.textContent='$'+val.toLocaleString();}
    else if(card.textContent.includes('%'))  {card.textContent=(val/100).toFixed(1)+'%';}
    else if(card.textContent.includes('ms')) {card.textContent=val+'ms';}
    else                                     {card.textContent=val.toLocaleString();}
  });
  if(charts.revenue){
    charts.revenue.data.datasets[0].data=charts.revenue.data.datasets[0].data.map(
      ()=>Math.floor(Math.random()*500)+800);
    charts.revenue.update('none');
  }
}
function startLiveUpdates(){updateInterval=setInterval(()=>liveMode&&updateLiveData(),5000);}
function stopRealTimeUpdates(){}

/* —————————————————  OTHER FUNCTIONS  ————————————————— */
/*  handleTierUpgrade, validateEmail, showToast, addLiveActivity,
    updateChart, updateViolationsChart, toggleLiveMode,
    emergencyMode, openModal, PWA helpers … are identical to original  */

/*  (for brevity they’re not repeated – they did not need fixes)  */
    </script>
</body>
</html>
