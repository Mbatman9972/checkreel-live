<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CheckReel Dashboard</title>
<link rel="icon" type="image/x-icon" href="images/logo.png">
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
background: linear-gradient(135deg, #1e3c72 0%, #2a5298 25%, #667eea 50%, #764ba2 75%, #8e44ad 100%);
min-height: 100vh;
color: #333;
}

body[dir="rtl"] {
    direction: rtl;
}

body[dir="rtl"] .container {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
}

body[dir="rtl"] .card {
    display: block !important;
    visibility: visible !important;
}

.container {
max-width: 1200px;
margin: 0 auto;
padding: 20px;
}

.header {
display: flex;
justify-content: space-between;
align-items: center;
background: rgba(255, 255, 255, 0.95);
backdrop-filter: blur(10px);
padding: 15px 30px;
border-radius: 15px;
margin-bottom: 30px;
box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.logo-section {
display: flex;
align-items: center;
gap: 15px;
}

.logo-img {
width: 45px;
height: 45px;
border-radius: 10px;
}

.logo-text {
font-size: 24px;
font-weight: bold;
background: linear-gradient(45deg, #1e3c72, #667eea);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
}

.user-section {
display: flex;
align-items: center;
gap: 20px;
}

.tier-badge {
padding: 8px 16px;
border-radius: 20px;
font-size: 12px;
font-weight: 600;
text-transform: uppercase;
letter-spacing: 0.5px;
}

.tier-free { background: #e3f2fd; color: #1976d2; }
.tier-plus { background: #f3e5f5; color: #7b1fa2; }
.tier-premium { background: #fff3e0; color: #f57c00; }

.dashboard-grid {
display: grid;
grid-template-columns: 1fr 1fr 1fr;
gap: 20px;
margin-bottom: 30px;
}

.card {
background: rgba(255, 255, 255, 0.95);
backdrop-filter: blur(10px);
border-radius: 20px;
padding: 25px;
box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.card h2 {
margin-bottom: 20px;
color: #333;
display: flex;
align-items: center;
gap: 10px;
font-size: 18px;
}

.region-grid {
display: grid;
grid-template-columns: repeat(2, 1fr);
gap: 10px;
margin-bottom: 15px;
}

.region-option {
display: flex;
flex-direction: column;
align-items: center;
padding: 15px;
border: 2px solid #e0e0e0;
border-radius: 12px;
cursor: pointer;
transition: all 0.3s ease;
background: white;
text-align: center;
}

.region-option:hover {
transform: translateY(-2px);
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
}

.region-option.selected {
border-color: #1e3c72;
background: linear-gradient(135deg, #1e3c72 0%, #667eea 100%);
color: white;
animation: glowPulse 2s infinite ease-in-out;
}

@keyframes glowPulse {
0%, 100% {
box-shadow: 0 0 20px rgba(30, 60, 114, 0.7);
}
50% {
box-shadow: 0 0 30px rgba(30, 60, 114, 1), 0 0 40px rgba(102, 126, 234, 0.8);
}
}

.region-icon {
width: 35px;
height: 35px;
margin-bottom: 8px;
border-radius: 6px;
object-fit: cover;
}

.region-name {
font-size: 12px;
font-weight: 600;
}

.platforms-grid {
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 12px;
}

.platform-option {
display: flex;
flex-direction: column;
align-items: center;
padding: 15px;
border: 2px solid #e0e0e0;
border-radius: 12px;
cursor: pointer;
transition: all 0.3s ease;
background: white;
position: relative;
overflow: hidden;
}

.platform-option:hover {
transform: translateY(-2px);
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.platform-option.selected {
border-color: #ff1493;
background: linear-gradient(135deg, #ff1493 0%, #ff69b4 100%);
color: white;
animation: pinkGlow 2s infinite ease-in-out;
}

@keyframes pinkGlow {
0%, 100% {
box-shadow: 0 0 20px rgba(255, 20, 147, 0.7);
}
50% {
box-shadow: 0 0 30px rgba(255, 20, 147, 1), 0 0 40px rgba(255, 105, 180, 0.8);
}
}

.platform-icon {
width: 35px;
height: 35px;
margin-bottom: 8px;
border-radius: 6px;
object-fit: cover;
transition: all 0.3s ease;
opacity: 1;
}

.platform-option.selected .platform-icon {
opacity: 1;
filter: brightness(1.2) contrast(1.1);
}

.platform-name {
font-size: 11px;
font-weight: 600;
text-align: center;
}

.upload-area {
border: 3px dashed #ddd;
border-radius: 15px;
padding: 30px;
text-align: center;
cursor: pointer;
transition: all 0.3s ease;
background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
}

.upload-area:hover {
border-color: #1e3c72;
background: linear-gradient(135deg, #e3f2fd 0%, #f8f9fa 100%);
}

.upload-area.dragover {
border-color: #1e3c72;
background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
transform: scale(1.02);
}

.upload-icon {
font-size: 36px;
margin-bottom: 10px;
display: block;
}

.file-info {
display: none;
text-align: center;
padding: 20px;
background: #f8f9fa;
border-radius: 10px;
border: 2px solid #28a745;
}

.file-name {
font-weight: 600;
margin-bottom: 5px;
}

.remove-file {
background: #dc3545;
color: white;
border: none;
padding: 8px 16px;
border-radius: 5px;
cursor: pointer;
margin-top: 10px;
}

.tier-selection {
background: rgba(255, 255, 255, 0.95);
backdrop-filter: blur(10px);
border-radius: 20px;
padding: 25px;
margin-bottom: 20px;
box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.tier-plans {
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 15px;
margin-top: 15px;
}

.tier-plan {
background: white;
border: 2px solid #e0e0e0;
border-radius: 15px;
padding: 20px;
text-align: center;
cursor: pointer;
transition: all 0.3s ease;
position: relative;
}

.tier-plan:hover {
transform: translateY(-3px);
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
}

.tier-plan.active {
border-color: #1e3c72;
background: linear-gradient(135deg, #1e3c72 0%, #667eea 100%);
color: white;
}

.tier-plan.recommended {
border-color: #ff6b6b;
}

.tier-plan.recommended::before {
content: "RECOMMENDED";
position: absolute;
top: -10px;
left: 50%;
transform: translateX(-50%);
background: #ff6b6b;
color: white;
padding: 4px 12px;
border-radius: 12px;
font-size: 10px;
font-weight: bold;
}

.tier-name {
font-size: 16px;
font-weight: bold;
margin-bottom: 8px;
}

.tier-price {
font-size: 18px;
font-weight: bold;
color: #1e3c72;
margin-bottom: 8px;
}

.tier-plan.active .tier-price {
color: white;
}

.tier-scans {
font-size: 12px;
opacity: 0.8;
margin-bottom: 10px;
}

.tier-features {
font-size: 11px;
opacity: 0.9;
line-height: 1.4;
}

.selection-alert {
background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
color: white;
padding: 15px 25px;
border-radius: 10px;
margin-bottom: 20px;
text-align: center;
font-weight: 600;
box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
}

.selection-alert.hidden {
display: none;
}

.scan-section {
text-align: center;
margin-top: 30px;
position: relative;
z-index: 10;
}

.scan-btn {
background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
color: white;
border: none;
padding: 15px 40px;
border-radius: 25px;
font-size: 18px;
font-weight: 600;
cursor: pointer;
transition: all 0.3s ease;
display: inline-flex;
align-items: center;
gap: 10px;
min-width: 200px;
justify-content: center;
position: relative;
}

.scan-btn:disabled {
background: #ccc;
cursor: not-allowed;
}

.scan-btn.ready {
background: linear-gradient(135deg, #1e3c72 0%, #667eea 100%);
box-shadow: 0 8px 25px rgba(30, 60, 114, 0.3);
}

.scan-btn.ready:hover {
transform: translateY(-2px);
box-shadow: 0 12px 35px rgba(30, 60, 114, 0.4);
}

.btn-loader {
display: none;
width: 20px;
height: 20px;
border: 2px solid transparent;
border-top: 2px solid white;
border-radius: 50%;
animation: spin 1s linear infinite;
}

.btn-loader.active {
display: block;
}

@keyframes spin {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}

.scan-history {
background: rgba(255, 255, 255, 0.95);
backdrop-filter: blur(10px);
border-radius: 20px;
padding: 25px;
margin-top: 50px;
margin-bottom: 30px;
box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
display: block;
}

.scan-history.visible {
display: block;
}

.history-tabs {
display: flex;
gap: 10px;
margin-bottom: 20px;
border-bottom: 2px solid #e0e0e0;
}

.history-tab {
padding: 10px 20px;
background: none;
border: none;
cursor: pointer;
font-weight: 600;
color: #666;
transition: all 0.3s ease;
border-bottom: 3px solid transparent;
}

.history-tab.active {
color: #1e3c72;
border-bottom-color: #1e3c72;
}

.history-list {
max-height: 300px;
overflow-y: auto;
}

.history-item {
display: flex;
justify-content: space-between;
align-items: center;
padding: 15px;
background: #f8f9fa;
border-radius: 10px;
margin-bottom: 10px;
cursor: pointer;
transition: all 0.3s ease;
}

.history-item:hover {
background: #e3f2fd;
transform: translateX(5px);
}

.history-date {
font-size: 12px;
color: #666;
}

.results-section {
display: none;
margin-top: 40px;
margin-bottom: 40px;
}

.score-display {
display: flex;
align-items: center;
justify-content: center;
gap: 40px;
margin-bottom: 40px;
padding: 20px;
}

.score-circle {
width: 120px;
height: 120px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
position: relative;
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.score-circle::before {
content: '';
width: 80px;
height: 80px;
background: white;
border-radius: 50%;
position: absolute;
}

.score-value {
font-size: 24px;
font-weight: bold;
z-index: 1;
color: #333;
}

.status-indicator {
display: flex;
align-items: center;
gap: 10px;
font-size: 18px;
font-weight: 600;
}

.status-icon {
font-size: 24px;
}

.results-grid {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 20px;
}

.issues-card, .recommendations-card {
background: white;
padding: 20px;
border-radius: 15px;
box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
}

.issue-item, .recommendation-item {
display: flex;
align-items: flex-start;
gap: 12px;
padding: 15px;
margin-bottom: 12px;
background: #f8f9fa;
border-radius: 8px;
cursor: pointer;
transition: all 0.3s ease;
line-height: 1.4;
min-height: 60px;
}

.issue-item:hover, .recommendation-item:hover {
background: #e3f2fd;
transform: translateX(5px);
}

.insight-modal {
display: none;
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0.8);
z-index: 1000;
padding: 20px;
}

.insight-content {
background: white;
border-radius: 20px;
padding: 30px;
max-width: 500px;
margin: 50px auto;
position: relative;
}

.insight-content h3 {
margin-bottom: 20px;
color: #1e3c72;
}

.stats-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
gap: 15px;
margin-bottom: 20px;
}

.stat-card {
background: rgba(255, 255, 255, 0.95);
backdrop-filter: blur(10px);
padding: 15px;
border-radius: 15px;
text-align: center;
box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
}

.stat-number {
font-size: 20px;
font-weight: bold;
color: #1e3c72;
margin-bottom: 5px;
}

.stat-label {
color: #666;
font-size: 12px;
}

.footer {
text-align: center;
padding: 20px 0;
color: rgba(255, 255, 255, 0.8);
font-size: 14px;
margin-top: 40px;
}

.platform-tag, .region-tag, .score-tag {
background: #e3f2fd;
color: #1976d2;
padding: 2px 8px;
border-radius: 12px;
font-size: 11px;
font-weight: 600;
}

@media (max-width: 1024px) {
.dashboard-grid {
grid-template-columns: 1fr 1fr;
}
}

@media (max-width: 768px) {
.dashboard-grid {
grid-template-columns: 1fr;
}
.platforms-grid {
grid-template-columns: repeat(2, 1fr);
}
.region-grid {
grid-template-columns: 1fr;
}
.tier-plans {
grid-template-columns: 1fr;
}
.score-display {
flex-direction: column;
gap: 20px;
}
}
</style>
</head>
<body>
<div class="container">
<div class="header">
<div class="logo-section">
<img src="images/logo.png" alt="CheckReel Logo" class="logo-img">
<span class="logo-text">CheckReel</span>
</div>
<div class="user-section">
<span id="scansLeft">3 scans left</span>
<span id="tierBadge" class="tier-badge tier-free">Free Trial</span>
</div>
</div>

<div class="tier-selection">
<h2 id="choose-plan">Choose Your Plan</h2>
<div class="tier-plans">
<div class="tier-plan active" data-tier="free" onclick="selectTier('free')">
<div class="tier-name" id="free-trial">Free Trial</div>
<div class="tier-price">$0</div>
<div class="tier-scans" id="free-scans">3 scans</div>
<div class="tier-features" id="free-features">Basic compliance check<br>Standard results</div>
</div>
<div class="tier-plan recommended" data-tier="plus" onclick="selectTier('plus')">
<div class="tier-name" id="plus-tier">Plus</div>
<div class="tier-price">$4.99/<span id="per-month">mo</span></div>
<div class="tier-scans" id="plus-scans">20 scans/month</div>
<div class="tier-features" id="plus-features">Enhanced compliance check<br>Detailed insights<br>Scan history<br>Priority support</div>
</div>
<div class="tier-plan" data-tier="premium" onclick="selectTier('premium')">
<div class="tier-name" id="premium-tier">Premium</div>
<div class="tier-price">$9.99/<span id="per-month-premium">mo</span></div>
<div class="tier-scans" id="premium-scans">40 scans/month</div>
<div class="tier-features" id="premium-features">Full compliance suite<br>Advanced analytics<br>Team features<br>White-label reports<br>API access<br>Dedicated support</div>
</div>
</div>
</div>

<!-- Dynamic Upload Section -->
<div class="dashboard-grid">
<div class="card">
<h2 id="select-region">🌍 Select Region</h2>
<div class="region-grid">
<div class="region-option selected" data-region="middle-east" onclick="selectRegion('middle-east')">
<img src="images/region-icons/middle-east.png" alt="Middle East" class="region-icon">
<span class="region-name" id="middle-east">Middle East</span>
</div>
<div class="region-option" data-region="global" onclick="selectRegion('global')">
<img src="images/region-icons/global.png" alt="Global" class="region-icon">
<span class="region-name" id="global">Global</span>
</div>
<div class="region-option" data-region="europe" onclick="selectRegion('europe')">
<img src="images/region-icons/europe.png" alt="Europe" class="region-icon">
<span class="region-name" id="europe">Europe</span>
</div>
<div class="region-option" data-region="mena" onclick="selectRegion('mena')">
<img src="images/region-icons/mena.png" alt="MENA" class="region-icon">
<span class="region-name" id="mena">MENA</span>
</div>
</div>
</div>

<div class="card">
<h2 id="select-platform">📱 Select Target Platform <span id="platformCounter"></span></h2>
<div class="platforms-grid">
<div class="platform-option selected" data-platform="tiktok" onclick="selectPlatform('tiktok')">
<img src="images/tiktok.png" alt="TikTok" class="platform-icon">
<span class="platform-name">TikTok</span>
</div>
<div class="platform-option" data-platform="youtube" onclick="selectPlatform('youtube')">
<img src="images/youtube.png" alt="YouTube" class="platform-icon">
<span class="platform-name">YouTube</span>
</div>
<div class="platform-option" data-platform="instagram" onclick="selectPlatform('instagram')">
<img src="images/instagram.png" alt="Instagram" class="platform-icon">
<span class="platform-name">Instagram</span>
</div>
<div class="platform-option" data-platform="facebook" onclick="selectPlatform('facebook')">
<img src="images/facebook.png" alt="Facebook" class="platform-icon">
<span class="platform-name">Facebook</span>
</div>
<div class="platform-option" data-platform="twitter" onclick="selectPlatform('twitter')">
<img src="images/twitter.png" alt="Twitter" class="platform-icon">
<span class="platform-name">Twitter</span>
</div>
<div class="platform-option" data-platform="snapchat" onclick="selectPlatform('snapchat')">
<img src="images/snapchat.png" alt="Snapchat" class="platform-icon">
<span class="platform-name">Snapchat</span>
</div>
</div>
</div>

<div class="card">
<h2 id="upload-content">📁 Upload Content to Check</h2>
<div id="selectionAlert" class="selection-alert hidden">
<span id="selection-alert">Please select a region and platform before uploading content for analysis</span>
</div>
<div class="upload-area" id="uploadArea">
<div class="upload-icon">📁</div>
<p id="drop-here">Drop your content here</p>
<p id="click-browse">or click to browse files</p>
<small>Supports: MP4, MOV, AVI, MP3, WAV, JPG, PNG (Max: 100MB)</small>
</div>
<div class="file-info" id="fileInfo">
<div class="file-name" id="fileName"></div>
<div class="file-size" id="fileSize"></div>
<button class="remove-file" id="removeFile">Remove File</button>
</div>
<input type="file" id="fileInput" accept="video/*,audio/*,image/*" style="display: none;">
</div>
</div>

<div class="scan-section">
<button class="scan-btn ready" id="scanBtn">
<div class="btn-loader" id="btnLoader"></div>
<span id="start-check">Start Content Check</span>
</button>
</div>

<!-- Scan History Section -->
<div class="scan-history visible" id="scanHistory">
<div class="history-tabs">
<button class="history-tab active" data-filter="all" id="all-scans">All Scans</button>
<button class="history-tab" data-filter="region" id="by-region">By Region</button>
<button class="history-tab" data-filter="platform" id="by-platform">By Platform</button>
</div>

<h3 id="scan-history-title">Scan History</h3>
<div class="history-list" id="historyList">
<div class="history-item">
<div>
<div class="file-name">Screenshot 2025-05-24 200920.png</div>
<div class="history-date">5/31/2025</div>
</div>
<div>
<span class="platform-tag" data-translate="tiktok">TikTok</span> | 
<span class="region-tag" data-translate="middle-east">Middle East</span> | 
<span class="score-tag" data-translate="score">Score: 55</span>
</div>
</div>
<div class="history-item">
<div>
<div class="file-name">Screenshot 2025-05-24 213530.png</div>
<div class="history-date">5/31/2025</div>
</div>
<div>
<span class="platform-tag" data-translate="tiktok">TikTok</span> | 
<span class="region-tag" data-translate="middle-east">Middle East</span> | 
<span class="score-tag" data-translate="score">Score: 55</span>
</div>
</div>
<div class="history-item">
<div>
<div class="file-name">Screenshot 2025-05-25 002715.png</div>
<div class="history-date">5/31/2025</div>
</div>
<div>
<span class="platform-tag" data-translate="tiktok">TikTok</span> | 
<span class="region-tag" data-translate="middle-east">Middle East</span> | 
<span class="score-tag" data-translate="score">Score: 85</span>
</div>
</div>
</div>
</div>

<!-- Results Section -->
<div class="results-section" id="resultsSection">
<div class="score-display" id="scoreDisplay">
<div class="score-circle" id="scoreCircle" style="background: linear-gradient(135deg, #dc3545, #e74c3c);">
<div class="score-value" id="scoreValue">55</div>
</div>
<div class="status-indicator">
<span class="status-icon" id="statusIcon">❌</span>
<span id="statusText">مشاكل كبيرة - لا تنشر</span>
</div>
</div>

<div class="results-grid">
<div class="issues-card">
<h3 id="issues-found">Issues Found</h3>
<div id="issuesList">
<div class="issue-item">
<span style="font-size: 18px;">🔊</span>
<span>مستويات الصوت تتجاوز حدود تيك توك</span>
</div>
<div class="issue-item">
<span style="font-size: 18px;">📋</span>
<span>قد يخالف المحتوى إرشادات مجتمع الشرق الأوسط</span>
</div>
</div>
</div>
<div class="recommendations-card">
<h3 id="recommendations">Recommendations</h3>
<div id="recommendationsList">
<div class="recommendation-item">
<span style="font-size: 18px;">📈</span>
<span>استخدم الهاشتاجات الرائجة لتيك توك</span>
</div>
<div class="recommendation-item">
<span style="font-size: 18px;">⏰</span>
<span>أفضل وقت للنشر في الشرق الأوسط: 7-9 مساءً بالتوقيت المحلي</span>
</div>
</div>
</div>
</div>
</div>

<!-- Stats Grid -->
<div class="stats-grid">
<div class="stat-card">
<div class="stat-number" id="statScansUsed">0</div>
<div class="stat-label" id="scans-used">Scans Used (Testing)</div>
</div>
</div>

<div id="insightModal" class="insight-modal">
<div class="insight-content">
<button class="close-modal" onclick="closeInsightModal()">&times;</button>
<h3 id="insightTitle">Insight Details</h3>
<div id="insightContent"></div>
</div>
</div>

<div class="footer">
<p>&copy; 2025 CheckReel. All rights reserved. Copyright Protected.</p>
</div>
</div>

<script src="lang-loader.js"></script>

<script>
// Global variables
let selectedFile = null;
let selectedPlatforms = ['tiktok'];
let selectedRegion = 'middle-east';
let selectedCountry = null;
let currentTier = 'free';
let scanHistory = [];
let currentLanguage = 'en';

// Safe storage wrapper
if (!window.safeStorage) {
  window.safeStorage = {
    getItem: (k) => { try { return localStorage.getItem(k); } catch { return null } },
    setItem: (k,v) => { try { localStorage.setItem(k,v) } catch {} },
    removeItem: (k) => { try { localStorage.removeItem(k) } catch {} }
  };
}

// Complete language content including scan results translations
const DASHBOARD_TRANSLATIONS = {
    en: {
        'choose-plan': 'Choose Your Plan',
        'free-trial': 'Free Trial',
        'plus-tier': 'Plus',
        'premium-tier': 'Premium',
        'per-month': 'mo',
        'free-scans': '3 scans',
        'plus-scans': '20 scans/month',
        'premium-scans': '40 scans/month',
        'free-features': 'Basic compliance check<br>Standard results',
        'plus-features': 'Enhanced compliance check<br>Detailed insights<br>Scan history<br>Priority support',
        'premium-features': 'Full compliance suite<br>Advanced analytics<br>Team features<br>White-label reports<br>API access<br>Dedicated support',
        'selection-alert': 'Please select a region and platform before uploading content for analysis',
        'select-region': '🌍 Select Region',
        'select-platform': '📱 Select Target Platform',
        'upload-content': '📁 Upload Content to Check',
        'drop-here': 'Drop your content here',
        'click-browse': 'or click to browse files',
        'start-check': 'Start Content Check',
        'analyzing': 'Analyzing...',
        'scan-history-title': 'Scan History',
        'all-scans': 'All Scans',
        'by-region': 'By Region',
        'by-platform': 'By Platform',
        'compliance-report': 'Compliance Report',
        'issues-found': 'Issues Found',
        'recommendations': 'Recommendations',
        'active-users': 'Active Users',
        'content-scanned': 'Content Scanned',
        'success-rate': 'Success Rate',
        'platforms': 'Platforms',
        'scans-used': 'Scans Used (Testing)',
        'scans-left': 'scans left',
        'recommended': 'RECOMMENDED',
        'middle-east': 'Middle East',
        'global': 'Global',
        'europe': 'Europe',
        'mena': 'MENA',
        'tiktok': 'TikTok',
        'youtube': 'YouTube',
        'instagram': 'Instagram',
        'facebook': 'Facebook',
        'twitter': 'Twitter',
        'snapchat': 'Snapchat',
        'score': 'Score',
        'majorIssues': 'Major Issues - Do Not Post',
        'minorIssues': 'Minor Issues - Review Recommended',
        'noIssues': 'Perfect! Ready to Post',
        'useTrendingHashtags': 'Use trending hashtags for {platform}',
        'bestPostingTime': 'Best posting time for {region}: 7-9 PM local',
        'audioLevelsExceed': 'Audio levels exceed {platform} limits',
        'contentViolateGuidelines': 'Content may violate {region} community guidelines'
    },
    fr: {
        'choose-plan': 'Choisissez votre plan',
        'free-trial': 'Essai gratuit',
        'plus-tier': 'Plus',
        'premium-tier': 'Premium',
        'per-month': 'mois',
        'free-scans': '3 analyses',
        'plus-scans': '20 analyses/mois',
        'premium-scans': '40 analyses/mois',
        'free-features': 'Vérification de conformité de base<br>Résultats standards',
        'plus-features': 'Vérification de conformité améliorée<br>Informations détaillées<br>Historique des analyses<br>Support prioritaire',
        'premium-features': 'Suite de conformité complète<br>Analyses avancées<br>Fonctionnalités d\'équipe<br>Rapports en marque blanche<br>Accès API<br>Support dédié',
        'selection-alert': 'Veuillez sélectionner une région et une plateforme avant de télécharger le contenu pour analyse',
        'select-region': '🌍 Sélectionner la région',
        'select-platform': '📱 Sélectionner la plateforme cible',
        'upload-content': '📁 Télécharger le contenu à vérifier',
        'drop-here': 'Déposez votre contenu ici',
        'click-browse': 'ou cliquez pour parcourir les fichiers',
        'start-check': 'Commencer la vérification du contenu',
        'analyzing': 'Analyse en cours...',
        'scan-history-title': 'Historique des analyses',
        'all-scans': 'Toutes les analyses',
        'by-region': 'Par région',
        'by-platform': 'Par plateforme',
        'compliance-report': 'Rapport de conformité',
        'issues-found': 'Problèmes trouvés',
        'recommendations': 'Recommandations',
        'active-users': 'Utilisateurs actifs',
        'content-scanned': 'Contenu analysé',
        'success-rate': 'Taux de réussite',
        'platforms': 'Plateformes',
        'scans-used': 'Analyses utilisées (Test)',
        'scans-left': 'analyses restantes',
        'recommended': 'RECOMMANDÉ',
        'middle-east': 'Moyen-Orient',
        'global': 'Global',
        'europe': 'Europe',
        'mena': 'MENA',
        'tiktok': 'TikTok',
        'youtube': 'YouTube',
        'instagram': 'Instagram',
        'facebook': 'Facebook',
        'twitter': 'Twitter',
        'snapchat': 'Snapchat',
        'score': 'Score',
        'majorIssues': 'Problèmes majeurs - Ne pas publier',
        'minorIssues': 'Problèmes mineurs - Révision recommandée',
        'noIssues': 'Parfait! Prêt à publier',
        'useTrendingHashtags': 'Utilisez des hashtags tendance pour {platform}',
        'bestPostingTime': 'Meilleur moment pour publier au {region}: 19h-21h heure locale',
        'audioLevelsExceed': 'Les niveaux audio dépassent les limites {platform}',
        'contentViolateGuidelines': 'Le contenu peut violer les directives communautaires du {region}'
    },
    ar: {
        'choose-plan': 'اختر خطتك',
        'free-trial': 'تجربة مجانية',
        'plus-tier': 'بلس',
        'premium-tier': 'بريميوم',
        'per-month': 'شهر',
        'free-scans': '3 فحوصات',
        'plus-scans': '20 فحص/شهر',
        'premium-scans': '40 فحص/شهر',
        'free-features': 'فحص امتثال أساسي<br>نتائج قياسية',
        'plus-features': 'فحص امتثال محسّن<br>رؤى مفصلة<br>سجل الفحوصات<br>دعم ذو أولوية',
        'premium-features': 'مجموعة امتثال كاملة<br>تحليلات متقدمة<br>ميزات الفريق<br>تقارير بعلامة تجارية خاصة<br>الوصول إلى API<br>دعم مخصص',
        'selection-alert': 'يرجى اختيار منطقة ومنصة قبل تحميل المحتوى للتحليل',
        'select-region': '🌍 اختر المنطقة',
        'select-platform': '📱 اختر المنصة المستهدفة',
        'upload-content': '📁 ارفع المحتوى للفحص',
        'drop-here': 'اسقط محتواك هنا',
        'click-browse': 'أو انقر لاستعراض الملفات',
        'start-check': 'ابدأ فحص المحتوى',
        'analyzing': 'جاري التحليل...',
        'scan-history-title': 'سجل الفحوصات',
        'all-scans': 'جميع الفحوصات',
        'by-region': 'حسب المنطقة',
        'by-platform': 'حسب المنصة',
        'compliance-report': 'تقرير الامتثال',
        'issues-found': 'المشاكل المكتشفة',
        'recommendations': 'التوصيات',
        'active-users': 'المستخدمون النشطون',
        'content-scanned': 'المحتوى المفحوص',
        'success-rate': 'معدل النجاح',
        'platforms': 'المنصات',
        'scans-used': 'الفحوصات المستخدمة (اختبار)',
        'scans-left': 'فحوصات متبقية',
        'recommended': 'موصى به',
        'middle-east': 'الشرق الأوسط',
        'global': 'عالمي',
        'europe': 'أوروبا',
        'mena': 'منطقة الشرق الأوسط وشمال أفريقيا',
        'tiktok': 'تيك توك',
        'youtube': 'يوتيوب',
        'instagram': 'إنستغرام',
        'facebook': 'فيسبوك',
        'twitter': 'تويتر',
        'snapchat': 'سناب شات',
        'score': 'النتيجة',
        'majorIssues': 'مشاكل كبيرة - لا تنشر',
        'minorIssues': 'مشاكل بسيطة - يُنصح بالمراجعة',
        'noIssues': 'مثالي! جاهز للنشر',
        'useTrendingHashtags': 'استخدم الهاشتاجات الرائجة لـ {platform}',
        'bestPostingTime': 'أفضل وقت للنشر في {region}: 7-9 مساءً بالتوقيت المحلي',
        'audioLevelsExceed': 'مستويات الصوت تتجاوز حدود {platform}',
        'contentViolateGuidelines': 'قد يخالف المحتوى إرشادات مجتمع {region}'
    }
};

// Get translation with placeholder replacement
function getTranslation(key, placeholders = {}) {
    const translations = DASHBOARD_TRANSLATIONS[currentLanguage] || DASHBOARD_TRANSLATIONS['en'];
    let text = translations[key] || key;
    
    // Replace placeholders
    Object.keys(placeholders).forEach(placeholder => {
        text = text.replace(`{${placeholder}}`, placeholders[placeholder]);
    });
    
    return text;
}

// Apply dashboard translations
function applyDashboardTranslations(lang) {
    const translations = DASHBOARD_TRANSLATIONS[lang] || DASHBOARD_TRANSLATIONS['en'];
    
    Object.keys(translations).forEach(key => {
        const element = document.getElementById(key);
        if (element) {
            if (key.includes('features')) {
                element.innerHTML = translations[key];
            } else {
                element.textContent = translations[key];
            }
        }
    });
    
    // Update scan history platform/region tags
    updateScanHistoryTranslations();
    updateTierDisplay();
}

// Update scan history translations
function updateScanHistoryTranslations() {
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        if (key === 'score') {
            // Keep the score number, just translate "Score:"
            const scoreMatch = element.textContent.match(/Score: (\d+)/);
            if (scoreMatch) {
                element.textContent = `${getTranslation('score')}: ${scoreMatch[1]}`;
            }
        } else {
            element.textContent = getTranslation(key);
        }
    });
}

// Initialize dashboard with language persistence
document.addEventListener('DOMContentLoaded', function() {
    currentLanguage = safeStorage.getItem('checkreel_language') || 'en';
    console.log('Dashboard loading with language:', currentLanguage);
    
    if (window.loadLanguageContent) {
        window.loadLanguageContent(currentLanguage);
    }
    
    setTimeout(() => {
        applyDashboardTranslations(currentLanguage);
        
        if (currentLanguage === 'ar') {
            document.body.setAttribute('dir', 'rtl');
            document.documentElement.setAttribute('dir', 'rtl');
        } else {
            document.body.removeAttribute('dir');
            document.documentElement.removeAttribute('dir');
        }
    }, 100);
    
    initializeUpload();
    updateTierDisplay();
    updateUserCounter();
    updateScansCounter();
    loadScanHistory();
    
    console.log('✅ Dashboard loaded with full language support');
});

// Tier selection
function selectTier(tier) {
    currentTier = tier;
    safeStorage.setItem('checkreel_tier', tier);
    
    document.querySelectorAll('.tier-plan').forEach(plan => {
        plan.classList.remove('active');
    });
    document.querySelector(`[data-tier="${tier}"]`).classList.add('active');
    
    if (tier !== 'free') {
        safeStorage.setItem('checkreel_scans_used', '0');
    }
    
    updateTierDisplay();
    updateScansCounter();
    updatePlatformCounter();
    
    const historySection = document.getElementById('scanHistory');
    if (tier === 'plus' || tier === 'premium') {
        historySection.classList.add('visible');
    } else {
        historySection.classList.remove('visible');
    }
}

// Region selection
function selectRegion(region) {
    selectedRegion = region;
    document.querySelectorAll('.region-option').forEach(opt => opt.classList.remove('selected'));
    document.querySelector(`[data-region="${region}"]`).classList.add('selected');
    updateScanButton();
    updateSelectionAlert();
}

// Platform selection
function selectPlatform(platform) {
    const userTier = safeStorage.getItem('checkreel_tier') || 'free';
    const platformElement = document.querySelector(`[data-platform="${platform}"]`);
    
    if (userTier === 'premium') {
        if (selectedPlatforms.includes(platform)) {
            selectedPlatforms = selectedPlatforms.filter(p => p !== platform);
            platformElement.classList.remove('selected');
        } else {
            if (selectedPlatforms.length < 3) {
                selectedPlatforms.push(platform);
                platformElement.classList.add('selected');
            } else {
                alert('Premium users can select up to 3 platforms per scan');
            }
        }
    } else {
        selectedPlatforms = [platform];
        document.querySelectorAll('.platform-option').forEach(opt => opt.classList.remove('selected'));
        platformElement.classList.add('selected');
    }
    
    updatePlatformCounter();
    updateScanButton();
    updateSelectionAlert();
}

// Update platform counter
function updatePlatformCounter() {
    const counterEl = document.getElementById("platformCounter");
    const userTier = safeStorage.getItem('checkreel_tier') || 'free';
    
    if (userTier === "premium" && counterEl) {
        counterEl.textContent = `(${selectedPlatforms.length}/3 selected)`;
    } else if (counterEl) {
        counterEl.textContent = '';
    }
}

// Update selection alert
function updateSelectionAlert() {
    const alert = document.getElementById('selectionAlert');
    if (selectedRegion && selectedPlatforms.length > 0) {
        alert.classList.add('hidden');
    } else {
        alert.classList.remove('hidden');
    }
}

// File upload functionality
function initializeUpload() {
    const uploadArea = document.getElementById('uploadArea');
    const fileInput = document.getElementById('fileInput');
    const fileInfo = document.getElementById('fileInfo');
    const removeFileBtn = document.getElementById('removeFile');
    
    if (!uploadArea || !fileInput) return;
    
    uploadArea.addEventListener('click', () => {
        if (!selectedRegion || selectedPlatforms.length === 0) {
            alert(getTranslation('selection-alert'));
            return;
        }
        fileInput.click();
    });
    
    fileInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (file && selectedRegion && selectedPlatforms.length > 0) {
            handleFileSelect(file);
        }
    });
    
    uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        if (selectedRegion && selectedPlatforms.length > 0) {
            uploadArea.classList.add('dragover');
        }
    });
    
    uploadArea.addEventListener('dragleave', (e) => {
        e.preventDefault();
        uploadArea.classList.remove('dragover');
    });
    
    uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadArea.classList.remove('dragover');
        if (!selectedRegion || selectedPlatforms.length === 0) {
            alert(getTranslation('selection-alert'));
            return;
        }
        const file = e.dataTransfer.files[0];
        if (file) {
            handleFileSelect(file);
        }
    });
    
    if (removeFileBtn) {
        removeFileBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            clearSelectedFile();
        });
    }
}

function handleFileSelect(file) {
    const allowedTypes = ['video/mp4', 'video/quicktime', 'image/jpeg', 'image/png', 'audio/mp3', 'audio/wav'];
    if (!allowedTypes.includes(file.type)) {
        alert('Unsupported file type. Please select MP4, MOV, JPG, PNG, MP3, or WAV files.');
        return;
    }
    
    const maxSize = 100 * 1024 * 1024;
    if (file.size > maxSize) {
        alert('File size too large. Please select a file smaller than 100MB.');
        return;
    }
    
    selectedFile = file;
    displayFileInfo(file);
    updateScanButton();
}

function displayFileInfo(file) {
    const uploadArea = document.getElementById('uploadArea');
    const fileInfo = document.getElementById('fileInfo');
    const fileName = document.getElementById('fileName');
    const fileSize = document.getElementById('fileSize');
    
    if (fileName) fileName.textContent = file.name;
    if (fileSize) fileSize.textContent = formatFileSize(file.size);
    if (uploadArea) uploadArea.style.display = 'none';
    if (fileInfo) fileInfo.style.display = 'block';
}

function clearSelectedFile() {
    const uploadArea = document.getElementById('uploadArea');
    const fileInfo = document.getElementById('fileInfo');
    const fileInput = document.getElementById('fileInput');
    
    selectedFile = null;
    if (fileInput) fileInput.value = '';
    if (uploadArea) uploadArea.style.display = 'block';
    if (fileInfo) fileInfo.style.display = 'none';
    updateScanButton();
}

function formatFileSize(bytes) {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

function updateScanButton() {
    const scanBtn = document.getElementById('scanBtn');
    if (!scanBtn) return;
    
    const canScan = selectedFile && selectedPlatforms.length > 0 && selectedRegion;
    scanBtn.disabled = !canScan;
    
    if (canScan) {
        scanBtn.classList.add('ready');
    } else {
        scanBtn.classList.remove('ready');
    }
}

// Scan functionality
const scanBtn = document.getElementById('scanBtn');
if (scanBtn) {
    scanBtn.addEventListener('click', async function() {
        if (!selectedFile || selectedPlatforms.length === 0 || !selectedRegion) return;
        
        if (!checkScanLimit()) {
            alert('You have reached your scan limit! Please upgrade your plan.');
            return;
        }
        
        await performScan();
    });
}

function checkScanLimit() {
    const userTier = safeStorage.getItem('checkreel_tier') || 'free';
    const scansUsed = parseInt(safeStorage.getItem('checkreel_scans_used') || '0');
    const limits = {
        free: 3,
        plus: 20,
        premium: 40
    };
    return scansUsed < limits[userTier];
}

async function performScan() {
    const scanBtn = document.getElementById('scanBtn');
    const btnText = document.getElementById('start-check');
    const btnLoader = document.getElementById('btnLoader');
    const resultsSection = document.getElementById('resultsSection');
    
    if (!scanBtn) return;
    
    scanBtn.disabled = true;
    if (btnText) btnText.textContent = getTranslation('analyzing');
    if (btnLoader) btnLoader.classList.add('active');
    
    try {
        await new Promise(resolve => setTimeout(resolve, 3000));
        
        const results = generateDynamicResults();
        displayResults(results);
        saveScanToHistory(results);
        incrementScanCount();
        updateTierDisplay();
        updateScansCounter();
        
        if (resultsSection) {
            resultsSection.style.display = 'block';
            resultsSection.scrollIntoView({ behavior: 'smooth' });
        }
        
    } catch (error) {
        console.error('Scan error:', error);
        alert('An error occurred during scanning. Please try again.');
    } finally {
        scanBtn.disabled = false;
        if (btnText) btnText.textContent = getTranslation('start-check');
        if (btnLoader) btnLoader.classList.remove('active');
    }
}

function generateDynamicResults() {
    const userTier = safeStorage.getItem('checkreel_tier') || 'free';
    const scenarios = [
        { score: 95, issueCount: 0 },
        { score: 85, issueCount: 2 },
        { score: 70, issueCount: 4 },
        { score: 55, issueCount: 6 },
        { score: 40, issueCount: 8 }
    ];
    
    const scenario = scenarios[Math.floor(Math.random() * scenarios.length)];
    let issues, recommendations, status, statusIcon;
    
    // Generate multilingual status messages
    if (scenario.score >= 90) {
        status = getTranslation('noIssues');
        statusIcon = '✅';
    } else if (scenario.score >= 70) {
        status = getTranslation('minorIssues');
        statusIcon = '⚠️';
    } else {
        status = getTranslation('majorIssues');
        statusIcon = '❌';
    }
    
    // Generate multilingual issues and recommendations with platform/region context
    const platformText = selectedPlatforms.map(p => getTranslation(p)).join(', ');
    const regionText = getTranslation(selectedRegion);
    
    if (userTier === 'free') {
        issues = scenario.issueCount > 0 ? [
            { 
                icon: '⚠️', 
                text: `${scenario.issueCount} compliance issues detected for ${platformText}`
            }
        ] : [];
        recommendations = [
            { 
                icon: '💡', 
                text: 'Upgrade to Plus or Premium for detailed analysis'
            }
        ];
    } else if (userTier === 'plus') {
        issues = scenario.issueCount > 0 ? [
            { 
                icon: '🔊', 
                text: getTranslation('audioLevelsExceed', { platform: platformText })
            },
            { 
                icon: '📋', 
                text: getTranslation('contentViolateGuidelines', { region: regionText })
            }
        ].slice(0, Math.min(scenario.issueCount, 2)) : [];
        
        recommendations = [
            { 
                icon: '📈', 
                text: getTranslation('useTrendingHashtags', { platform: platformText })
            },
            { 
                icon: '⏰', 
                text: getTranslation('bestPostingTime', { region: regionText })
            }
        ];
    } else { // premium
        issues = scenario.issueCount > 0 ? [
            { 
                icon: '🎵', 
                text: 'Audio enhancement needed - our AI recommends voice optimization'
            },
            { 
                icon: '📹', 
                text: 'Visual quality below platform standards'
            },
            { 
                icon: '⏱️', 
                text: `Video pacing needs adjustment for ${platformText}`
            }
        ].slice(0, Math.min(scenario.issueCount, 3)) : [];
        
        recommendations = [
            { 
                icon: '🧠', 
                text: 'AI Analysis: Adjust content pacing for better engagement'
            },
            { 
                icon: '🎯', 
                text: 'Optimization tip: Add stronger hooks in first 3 seconds'
            },
            { 
                icon: '⭐', 
                text: 'Our advanced AI suggests format tweaks for viral potential'
            }
        ];
    }
    
    return {
        score: scenario.score,
        status,
        statusIcon,
        issues,
        recommendations
    };
}

function displayResults(results) {
    // Update score display
    const scoreValue = document.getElementById('scoreValue');
    const statusText = document.getElementById('statusText');
    const statusIcon = document.getElementById('statusIcon');
    const scoreCircle = document.getElementById('scoreCircle');
    
    if (scoreValue) scoreValue.textContent = results.score;
    if (statusText) statusText.textContent = results.status;
    if (statusIcon) statusIcon.textContent = results.statusIcon;
    
    // Color code the score circle
    if (scoreCircle) {
        if (results.score >= 90) {
            scoreCircle.style.background = 'linear-gradient(135deg, #28a745, #20c997)';
        } else if (results.score >= 70) {
            scoreCircle.style.background = 'linear-gradient(135deg, #ffc107, #fd7e14)';
        } else {
            scoreCircle.style.background = 'linear-gradient(135deg, #dc3545, #e74c3c)';
        }
    }
    
    // Display issues
    const issuesList = document.getElementById('issuesList');
    if (issuesList) {
        issuesList.innerHTML = '';
        results.issues.forEach(issue => {
            const issueItem = document.createElement('div');
            issueItem.className = 'issue-item';
            issueItem.innerHTML = `
                <span style="font-size: 18px;">${issue.icon}</span>
                <span>${issue.text}</span>
            `;
            issuesList.appendChild(issueItem);
        });
    }
    
    // Display recommendations
    const recommendationsList = document.getElementById('recommendationsList');
    if (recommendationsList) {
        recommendationsList.innerHTML = '';
        results.recommendations.forEach(rec => {
            const recItem = document.createElement('div');
            recItem.className = 'recommendation-item';
            recItem.innerHTML = `
                <span style="font-size: 18px;">${rec.icon}</span>
                <span>${rec.text}</span>
            `;
            recommendationsList.appendChild(recItem);
        });
    }
}

function saveScanToHistory(results) {
    const historyItem = {
        id: Date.now(),
        fileName: selectedFile.name,
        date: new Date().toLocaleDateString(),
        score: results.score,
        status: results.status,
        platforms: [...selectedPlatforms],
        region: selectedRegion,
        issues: results.issues.length,
        recommendations: results.recommendations.length
    };
    
    scanHistory.unshift(historyItem);
    safeStorage.setItem('checkreel_scan_history', JSON.stringify(scanHistory));
    loadScanHistory();
}

function incrementScanCount() {
    const currentCount = parseInt(safeStorage.getItem('checkreel_scans_used') || '0');
    safeStorage.setItem('checkreel_scans_used', (currentCount + 1).toString());
}

function updateTierDisplay() {
    const userTier = safeStorage.getItem('checkreel_tier') || 'free';
    const scansUsed = parseInt(safeStorage.getItem('checkreel_scans_used') || '0');
    const tierBadge = document.getElementById('tierBadge');
    const scansLeft = document.getElementById('scansLeft');
    
    const limits = {
        free: { limit: 3, name: getTranslation('free-trial') },
        plus: { limit: 20, name: getTranslation('plus-tier') },
        premium: { limit: 40, name: getTranslation('premium-tier') }
    };
    
    const tierInfo = limits[userTier];
    const remaining = Math.max(0, tierInfo.limit - scansUsed);
    
    if (tierBadge) {
        tierBadge.textContent = tierInfo.name;
        tierBadge.className = `tier-badge tier-${userTier}`;
    }
    
    if (scansLeft) {
        scansLeft.textContent = `${remaining} ${getTranslation('scans-left')}`;
    }
}

function updateUserCounter() {
    const randomUsers = Math.floor(Math.random() * 500) + 2500;
    const userEl = document.getElementById('statUsers');
    if (userEl) {
        userEl.textContent = randomUsers.toLocaleString();
    }
}

function updateScansCounter() {
    const scansUsed = parseInt(safeStorage.getItem('checkreel_scans_used') || '0');
    const scansEl = document.getElementById('statScansUsed');
    if (scansEl) {
        scansEl.textContent = scansUsed;
    }
}

function loadScanHistory() {
    const savedHistory = safeStorage.getItem('checkreel_scan_history');
    if (savedHistory) {
        try {
            scanHistory = JSON.parse(savedHistory);
        } catch (e) {
            scanHistory = [];
        }
    }
    
    const historyList = document.getElementById('historyList');
    if (historyList && scanHistory.length > 0) {
        historyList.innerHTML = '';
        scanHistory.slice(0, 5).forEach(item => {
            const historyItem = document.createElement('div');
            historyItem.className = 'history-item';
            
            const platformText = item.platforms.map(p => getTranslation(p)).join(', ');
            const regionText = getTranslation(item.region);
            
            historyItem.innerHTML = `
                <div>
                    <div class="file-name">${item.fileName}</div>
                    <div class="history-date">${item.date}</div>
                </div>
                <div>
                    <span class="platform-tag">${platformText}</span> | 
                    <span class="region-tag">${regionText}</span> | 
                    <span class="score-tag">${getTranslation('score')}: ${item.score}</span>
                </div>
            `;
            historyList.appendChild(historyItem);
        });
    }
}

function filterHistory(filter) {
    document.querySelectorAll('.history-tab').forEach(tab => tab.classList.remove('active'));
    document.querySelector(`[data-filter="${filter}"]`).classList.add('active');
    
    // Filter logic would go here
    loadScanHistory();
}

function closeInsightModal() {
    document.getElementById('insightModal').style.display = 'none';
}

// Add event listeners for history tabs
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.history-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            const filter = this.getAttribute('data-filter');
            filterHistory(filter);
        });
    });
});

// Language change handler - listen for changes from lang-loader.js
window.addEventListener('languageChanged', function(event) {
    currentLanguage = event.detail.language;
    applyDashboardTranslations(currentLanguage);
    
    if (currentLanguage === 'ar') {
        document.body.setAttribute('dir', 'rtl');
        document.documentElement.setAttribute('dir', 'rtl');
    } else {
        document.body.removeAttribute('dir');
        document.documentElement.removeAttribute('dir');
    }
    
    // Refresh scan history with new translations
    loadScanHistory();
});

console.log('✅ Dashboard fully loaded with complete multilingual support');
</script>
</body>
</html>card">
<div class="stat-number" id="statUsers">2,845</div>
<div class="stat-label" id="active-users">Active Users</div>
</div>
<div class="stat-card">
<div class="stat-number" id="statScanned">18,492</div>
<div class="stat-label" id="content-scanned">Content Scanned</div>
</div>
<div class="stat-card">
<div class="stat-number" id="statSuccess">94%</div>
<div class="stat-label" id="success-rate">Success Rate</div>
</div>
<div class="stat-card">
<div class="stat-number" id="statPlatforms">6</div>
<div class="stat-label" id="platforms">Platforms</div>
</div>
<div class="stat-